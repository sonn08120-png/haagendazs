<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/deagu_sub.css">
    <link rel="stylesheet" href="css/slickslider.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>
    <title>월간일정 &gt; 공연정보 &gt; 공연·전시 &gt; 대구문화예술회관</title>
</head>

<body>
    <header>
        <div class="header_warp">
            <div class="nav_warp">
                <div class="nav">
                    <div class="nav_top">
                        <h1><a href="index.html"><img src="image/logo_color.png" alt="대구문화예술회관로고"></a></h1>
                        <div class="nav_my">
                            <a href=""><img src="image/login_02.png" alt="로그인">로그인</a>
                            <a href=""><img src="image/mypage_02.png" alt="마이페이지">마이페이지</a>
                        </div>
                    </div>
                    <span></span>
                    <div class="nav_bottom">
                        <ul class="gnb">
                            <li class="nav_title">
                                <a href="#">공연·전시</a>
                                <div class="nav_hover">
                                    <ul class="nav_hover_warp">
                                            <li>
                                                <a href="">공연정보</a>
                                                <a href="#">진행중인공연</a>
                                                <a href="deagu_sub1.html">월간일정</a>
                                                <a href="#">연간일정</a>
                                            </li>
                                            <li>
                                                <a href="">전시정보</a>
                                                <a href="#">진행중인전시</a>
                                                <a href="#">월간일정</a>
                                                <a href="#">연간일정</a>
                                            </li>
                                            <li>
                                                <a href="">관람예절안내</a>
                                                <a href="daegu_sub2.html">공연예절</a>
                                                <a href="#">전시예절</a>
                                            </li>
                                            <li>
                                                <a href="">포토갤러리</a>
                                                <a href="#">갤러리바로가기</a>
                                            </li>
                                    </ul>
                                </div>
                            </li>
                            <li class="nav_title has-mega">
                                <a href="#">티켓예매</a>
                                <div class="nav_hover">
                                    <ul class="nav_hover_warp">
                                            <li>
                                                <a href="#">예매안내</a>
                                            </li>
                                            <li>
                                                <a href="#">예매확인 및 취소</a>
                                            </li>
                                            <li>
                                                <a href="#">좌석배치도</a>
                                            </li>
                                    </ul>
                                </div>
                            </li>
                            <li class="nav_title has-mega">
                                <a href="#">대관안내</a>
                                <div class="nav_hover">
                                    <ul class="nav_hover_warp">
                                        <li>
                                                <a href="#">시설안내</a>
                                            </li>
                                            <li>
                                                <a href="#">대관이용안내</a>
                                            </li>
                                            <li>
                                                <a href="#">사용료안내</a>
                                            </li>
                                            <li>
                                                <a href="#">관련조례</a>
                                            </li>
                                    </ul>
                                </div>
                            </li>
                            <li class="nav_title has-mega">
                                <a href="#">문화예술교육</a>
                                <div class="nav_hover">
                                    <ul class="nav_hover_warp">
                                            <li>
                                                <a href="#">예술아카데미소개</a>
                                            </li>
                                            <li>
                                                <a href="#">모집안내</a>
                                            </li>
                                            <li>
                                                <a href="#">공지사항</a>
                                            </li>
                                    </ul>
                                </div>
                            </li>
                            <li class="nav_title has-mega">
                                <a href="#">시립예술단</a>
                                <div class="nav_hover">
                                    <ul class="nav_hover_warp">
                                            <li>
                                                <a href="">국악단</a>
                                                <a href="#">소개</a>
                                                <a href="#">지휘자 및 단원현황</a>
                                                <a href="#">포토갤러리</a>
                                            </li>
                                            <li>
                                                <a href="">무용단</a>
                                                <a href="#">소개</a>
                                                <a href="#">지휘자 및 단원현황</a>
                                                <a href="#">포토갤러리</a>
                                            </li>
                                            <li>
                                                <a href="">극단</a>
                                                <a href="#">소개</a>
                                                <a href="#">지휘자 및 단원현황</a>
                                                <a href="#">포토갤러리</a>
                                            </li>
                                            <li>
                                                <a href="">소년소녀합창단</a>
                                                <a href="#">소개</a>
                                                <a href="#">지휘자 및 단원현황</a>
                                                <a href="#">포토갤러리</a>
                                            </li>
                                            <li>
                                                <a href="#">공연지원팀</a>
                                            </li>
                                    </ul>
                                </div>
                            </li>
                            <li class="nav_title has-mega">
                                <a href="#">회관소개</a>
                                <div class="nav_hover">
                                    <ul class="nav_hover_warp">
                                            <li>
                                                <a href="#">인사말</a>
                                            </li>
                                            <li>
                                                <a href="#">연혁</a>
                                            </li>
                                            <li>
                                                <a href="#">비전 및 전략</a>
                                            </li>
                                            <li>
                                                <a href="#">조직 및 연락처</a>
                                            </li>
                                            <li>
                                                <a href="#">BI소개</a>
                                            </li>
                                            <li>
                                                <a href="#">오시는길</a>
                                            </li>
                                    </ul>
                                </div>
                            </li>
                            <li class="nav_title has-mega">
                                <a href="#">열린광장</a>
                                <div class="nav_hover">
                                    <ul class="nav_hover_warp">
                                            <li>
                                                <a href="#">공지사항</a>
                                            </li>
                                            <li>
                                                <a href="#">관람후기</a>
                                            </li>
                                            <li>
                                                <a href="#">Q&A</a>
                                            </li>
                                            <li>
                                                <a href="#">자유게시판</a>
                                            </li>
                                            <li>
                                                <a href="#">고객의소리</a>
                                            </li>
                                            <li>
                                                <a href="#">분실물코너</a>
                                            </li>
                                            <li>
                                                <a href="#">로그인</a>
                                            </li>
                                    </ul>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div class="nav_bottom_img">
                            <a href=""><img src="image/Magnifier_02.png" alt="검색"></a>
                            <a href=""><img src="image/hambergur_02.png" alt="메뉴"></a>
                    </div>
                </div>
            </div>
            <script>
                // 상단 항목들
                const nav = document.querySelector('.nav_bottom');
                const titles = Array.from(document.querySelectorAll('.gnb > .nav_title'));

                function openItem(item) {
                    titles.forEach(li => li.classList.toggle('active', li === item));
                }
                function closeAll() {
                    titles.forEach(li => li.classList.remove('active'));
                }

                titles.forEach((li, idx) => {
                    const link = li.querySelector(':scope > a'); // 상단 a
                    if (!link) return;

                    // 마우스 올리면 열림
                    li.addEventListener('mouseenter', () => openItem(li));
                    // 탭 포커스되면 열림
                    link.addEventListener('focus', () => openItem(li));

                    // 키보드 내비게이션(선택): 좌우 이동, ESC 닫기
                    li.addEventListener('keydown', (e) => {
                        if (e.key === 'Escape') {
                            closeAll();
                            link.blur();
                        } else if (e.key === 'ArrowRight') {
                            e.preventDefault();
                            const next = titles[(idx + 1) % titles.length].querySelector(':scope > a');
                            next?.focus();
                        } else if (e.key === 'ArrowLeft') {
                            e.preventDefault();
                            const prev = titles[(idx - 1 + titles.length) % titles.length].querySelector(':scope > a');
                            prev?.focus();
                        }
                    });
                });

                // 메뉴 영역을 벗어나면 닫기 (조금의 딜레이로 떨림 방지)
                let hideTimer;
                nav.addEventListener('mouseleave', () => {
                    clearTimeout(hideTimer);
                    hideTimer = setTimeout(() => closeAll(), 120);
                });
                nav.addEventListener('mouseenter', () => clearTimeout(hideTimer));

                // 바깥 클릭하면 닫기
                document.addEventListener('click', (e) => {
                    if (!nav.contains(e.target)) closeAll();
                });

                // 전역 ESC
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') closeAll();
                });
            </script>
        </div>
        <div class="header_img">
            <b>공연정보</b>
        </div>
        <div class="snb_warp">
            <div class="snb">
                <div class="snb_left">
                    <div class="snb_home"><a href="index.html">
                            <img src="image/home.png" alt="">
                        </a></div>
                    <div class="snb_map"><a href="">
                            <p>공연·전시</p>
                        </a></div>
                    <div class="snb_map"><a href="">
                            <p>공연정보</p>
                        </a></div>
                    <div class="snb_map"><a href="">
                            <b>월간일정</b>
                        </a></div>
                </div>
                <div class="snb_right">
                    <div class="d-flex flex-column flex-lg-row mb-3">
                        <div>
                            <button onclick="shareInvitation()" class="text-underline ">
                                <img src="image/share.png" alt="">
                            </button>
                        </div>
                    </div>
                    <script>
                        function copyToClipboard(text) {
                            navigator.clipboard.writeText(text)
                                .then(() => {
                                    console.log('클립보드에 복사되었습니다.');
                                    alert('내용이 클립보드에 복사되었습니다.');
                                })
                                .catch((error) => {
                                    console.error('클립보드 복사 실패', error);
                                });
                        }

                        function shareInvitation() {
                            const textToShare = '공유할 내용';
                            const urlToShare = 'https://example.com' + "동적할당";

                            if (navigator.share) {
                                navigator.share({
                                    title: '공유할 제목',
                                    text: textToShare,
                                    url: urlToShare,
                                })
                                    .then(() => {
                                        console.log('공유 성공');
                                    })
                            } else {
                                copyToClipboard(`${textToShare} ${urlToShare}`);
                            }
                        }
                    </script>
                    <button onclick="return  printPage();"><img src="image/print.png" alt=""></button>
                    <script>
                        let initBodyHtml;

                        const printPage = () => {
                            window.print();
                        }

                        const beforePrint = () => {
                            initBodyHtml = document.body.innerHTML;
                            document.body.innerHTML = document.getElementById("print").innerHTML;
                        }

                        const afterPrint = () => {
                            document.body.innerHTML = initBodyHtml;
                        }

                        window.onbeforeprint = beforePrint;
                        window.onafterprint = afterPrint;
                    </script>
                </div>
            </div>
        </div>
    </header>
    <main>
        <div class="select">
            <div>
                <p>진행중인 공연</p>
            </div>
            <div class="active">
                <p>월간일정</p>
            </div>
            <div>
                <p>연간일정</p>
            </div>
        </div>
        <script>
            const items = document.querySelectorAll(".select div");

            items.forEach(item => {
                item.addEventListener("click", () => {
                    items.forEach(i => i.classList.remove("active"));
                    item.classList.add("active");
                });
            });
        </script>
        <div class="calendar-container">
            <div class="calendar-header">
                <button id="prevMonth"><img src="image/calender_arrow_left.png" alt=""></button>
                <h2 id="currentMonth">2025.10</h2>
                <button id="nextMonth"><img src="image/calender_arrow_right.png" alt=""></button>
            </div>

            <div class="legend">
                <div class="legend-item"><span class="legend-dot dot-show"></span>공연</div>
                <div class="legend-item"><span class="legend-dot dot-plan"></span>기획</div>
                <div class="legend-item"><span class="legend-dot dot-rent"></span>대관</div>
            </div>

            <table id="calendar"></table>
        </div>

        <script>
            const currentMonthEl = document.getElementById("currentMonth");
            const calendar = document.getElementById("calendar");
            let currentDate = new Date(2025, 9);

            const rawEvents = [
                { date: "2025-10-02", type: "show", title: "미술관 라이브", url: "#" },
                { date: "2025-10-05", type: "show", title: "대구시립교향악단 <체임버시리즈>", url: "#" },
                { date: "2025-10-06", type: "show", title: "이상 프로젝트 ‘이상과 카프카’", url: "#" },
                { date: "2025-10-07", type: "show", title: "대구시립국악단 제29회 청소년 협주곡의 밤", url: "#" },
                { date: "2025-10-08", type: "show", title: "시립합창단 <가을의 노래>", url: "#" },
                { date: "2025-10-09", type: "rent", title: "남진 전국 투어 콘서트", url: "#" },
                { date: "2025-10-10", type: "rent", title: "지브리&디즈니 영화음악 Festa", url: "#" },
                { date: "2025-10-12", type: "plan", title: "금난새의 11시 데이트 (8월)", url: "#" },
                { date: "2025-10-15", type: "plan", title: "전통연회극 <광대>", url: "#", img: "image/poster_03.png" },
                { date: "2025-10-15", type: "plan", title: "음악극 <적로-이슬의 노래>", url: "#" },
                { date: "2025-10-15", type: "rent", title: "제80주년 광복절 경축 음악회", url: "#" },
                { date: "2025-10-16", type: "plan", title: "전통연회극 <광대>", url: "#", img: "image/poster_03.png" },
                { date: "2025-10-17", type: "rent", title: "대구시민과 함께하는 여름음악회", url: "#" },
                { date: "2025-10-20", type: "show", title: "대구국제금관·타악페스티벌", url: "#" },
                { date: "2025-10-21", type: "show", title: "대구국제금관·타악페스티벌", url: "#" },
                { date: "2025-10-22", type: "show", title: "대구시립무용단 제88회 정기공연", url: "#" },
                { date: "2025-10-22", type: "rent", title: "민속악 연주단 선풍 10번째 이야기 ‘백유'", url: "#" },
                { date: "2025-10-23", type: "rent", title: "대구시립무용단 제88회 정기공연", url: "#" },
                { date: "2025-10-23", type: "show", title: "제 15회 삼원신협의밤 콘서트", url: "#" },
                { date: "2025-10-24", type: "show", title: "제 2회 달구벌문화예술 한마당", url: "#" },
                { date: "2025-10-27", type: "rent", title: "앙상블 이덴티테트 제2회 정기연주회", url: "#" },
                { date: "2025-10-27", type: "rent", title: "수요상설공연 - 전효진댄스컴퍼니", url: "#" },
                { date: "2025-10-29", type: "rent", title: "소나기 콘서트", url: "#" },
                { date: "2025-10-30", type: "rent", title: "대구무형유산제전", url: "#" },
                { date: "2025-10-30", type: "rent", title: "매직 드로잉 가족극 <두들팝>", url: "#" },
                { date: "2025-10-30", type: "rent", title: "iM 청춘페스타", url: "#" },
                { date: "2025-10-31", type: "rent", title: "대구무형유산제전", url: "#" },
                { date: "2025-10-31", type: "rent", title: "매직 드로잉 가족극 <두들팝>", url: "#" },
            ];

            const eventsByDate = rawEvents.reduce((acc, e) => {
                (acc[e.date] ||= []).push(e);
                return acc;
            }, {});

            function renderCalendar(date) {
                const year = date.getFullYear();
                const month = date.getMonth();
                currentMonthEl.textContent = `${year}.${String(month + 1).padStart(2, "0")}`;

                const firstDay = new Date(year, month, 1).getDay();
                const lastDate = new Date(year, month + 1, 0).getDate();

                let html = `
    <thead>
      <tr><th>일</th><th>월</th><th>화</th><th>수</th><th>목</th><th>금</th><th>토</th></tr>
    </thead>
    <tbody><tr>
  `;

                for (let i = 0; i < firstDay; i++) html += "<td></td>";

                for (let i = 1; i <= lastDate; i++) {
                    const day = new Date(year, month, i).getDay();
                    const key = `${year}-${String(month + 1).padStart(2, "0")}-${String(i).padStart(2, "0")}`;
                    const dayEvents = eventsByDate[key] || [];

                    html += `<td><div class="cell-content"><div class="date">${i}</div><div class="events">`;

                    dayEvents.forEach((e) => {
                        const hasCard = e.url && e.img;
                        html += `
        <div class="event ${e.type}">
          <span class="event-dot dot-${e.type}"></span>
          <a class="event-title" href="${e.url || '#'}" target="_blank" rel="noopener">${e.title}</a>
          ${hasCard ? `
          <div class="event-popover" aria-hidden="true">
            <div class="popover-card">
              <img src="${e.img}" alt="${e.title}">
              <div class="popover-text">
                <div class="popover-title">${e.title}</div>
                <a href"#" class="popover-btn" href="${e.url}" target="_blank" rel="noopener">상세보기</a>
              </div>
            </div>
          </div>` : ``}
        </div>
      `;
                    });

                    html += `</div></div></td>`;
                    if (day === 6 && i !== lastDate) html += "</tr><tr>";
                }

                html += "</tr></tbody>";
                calendar.innerHTML = html;

                attachPopoverPositioning();
            }

            function attachPopoverPositioning() {
                const GAP = 10;
                const MARGIN = 8;

                document.querySelectorAll(".event").forEach((evt) => {
                    const pop = evt.querySelector(".event-popover");
                    if (!pop) return;

                    const measureAndPlace = () => {
                        const prev = {
                            display: pop.style.display,
                            opacity: pop.style.opacity,
                            pointer: pop.style.pointerEvents,
                        };
                        pop.style.display = "block";
                        pop.style.opacity = "0";
                        pop.style.pointerEvents = "none";

                        requestAnimationFrame(() => {
                            const cardW = pop.offsetWidth || 280;
                            const cardH = pop.offsetHeight || 360;

                            const rect = evt.getBoundingClientRect();
                            const vw = window.innerWidth;
                            const vh = window.innerHeight;

                            let left = 0;
                            let top = evt.offsetHeight + GAP;

                            if (rect.top + top + cardH > vh - MARGIN) {
                                top = -(cardH + GAP);
                            }

                            let absLeft = rect.left + left;
                            if (absLeft < MARGIN) {
                                left += (MARGIN - absLeft);
                                absLeft = rect.left + left;
                            }
                            if (absLeft + cardW > vw - MARGIN) {
                                left -= (absLeft + cardW - (vw - MARGIN));
                            }

                            pop.style.left = `${left}px`;
                            pop.style.top = `${top}px`;

                            pop.style.display = prev.display || "";
                            pop.style.opacity = prev.opacity || "";
                            pop.style.pointerEvents = prev.pointer || "";
                        });
                    };

                    evt.addEventListener("mouseenter", measureAndPlace);
                    evt.addEventListener("focusin", measureAndPlace);
                });
            }

            function debounce(fn, delay = 150) {
                let t;
                return (...args) => {
                    clearTimeout(t);
                    t = setTimeout(() => fn.apply(null, args), delay);
                };
            }

            document.getElementById("prevMonth").addEventListener("click", () => {
                currentDate.setMonth(currentDate.getMonth() - 1);
                renderCalendar(currentDate);
            });
            document.getElementById("nextMonth").addEventListener("click", () => {
                currentDate.setMonth(currentDate.getMonth() + 1);
                renderCalendar(currentDate);
            });

            window.addEventListener("resize", debounce(() => attachPopoverPositioning(), 200));

            renderCalendar(currentDate);

            function wirePopoverOpenClose() {
                const OPEN_DELAY = 60;
                const CLOSE_DELAY = 140;

                document.querySelectorAll('.event').forEach(evt => {
                    const pop = evt.querySelector('.event-popover');
                    if (!pop) return;

                    let closeTimer = null, openTimer = null;

                    const open = () => {
                        clearTimeout(closeTimer);
                        if (evt.classList.contains('is-open')) return;
                        openTimer = setTimeout(() => evt.classList.add('is-open'), OPEN_DELAY);
                    };

                    const close = () => {
                        clearTimeout(openTimer);
                        closeTimer = setTimeout(() => evt.classList.remove('is-open'), CLOSE_DELAY);
                    };

                    evt.addEventListener('mouseenter', open);
                    evt.addEventListener('mouseleave', close);
                    evt.addEventListener('focusin', open);
                    evt.addEventListener('focusout', close);

                    pop.addEventListener('mouseenter', () => {
                        clearTimeout(closeTimer);
                        evt.classList.add('is-open');
                    });
                    pop.addEventListener('mouseleave', close);

                    evt.addEventListener('click', (e) => {
                        if (e.target.closest('.popover-btn')) return;
                        e.preventDefault();
                        evt.classList.toggle('is-open');
                    });
                    document.addEventListener('click', (e) => {
                        if (!evt.contains(e.target)) evt.classList.remove('is-open');
                    }, { capture: true });
                });
            }

            wirePopoverOpenClose();
        </script>
        <div class="exhibition_warp">
            <h2>이달의 공연</h2>
            <span></span>
            <div class="wrapper">
                <div class="slick">
                    <div>
                        <p class="plan_poster">팔공홀 / 기획</p>
                        <img src="image/poster_03.png" alt="">
                    </div>
                    <div>
                        <p class="plan_poster">대구문화예술회관 / 기획</p>
                        <img src="image/poster_07.png" alt="">
                    </div>
                    <div>
                        <p class="show_poster">팔공홀 / 공연</p>
                        <img src="image/poster_04.jpg" alt="">
                    </div>
                    <div>
                        <p class="rent_poster">팔공홀 / 대관</p>
                        <img src="image/poster_05.jpeg" alt="">
                    </div>
                    <div>
                        <p class="rent_poster">팔공홀 / 대관</p>
                        <img src="image/poster_02.jpg" alt="">
                    </div>
                </div>
            </div>
            <script>
                $(function () {
                    if ($('.slick').hasClass('slick-initialized')) {
                        $('.slick').slick('unslick');
                    }

                    const $slider = $('.slick');

                    $slider.slick({
                        autoplay: true,
                        pauseOnHover: true,
                        speed: 300,
                        cssEase: 'ease',
                        arrows: true,
                        infinite: true,
                        swipeToSlide: true,
                        rows: 1,
                        slidesToShow: 4,
                        slidesToScroll: 1,
                        responsive: [
                            { breakpoint: 1024, settings: { slidesToShow: 3 } },
                            { breakpoint: 600, settings: { slidesToShow: 2 } },
                            { breakpoint: 480, settings: { slidesToShow: 1 } }
                        ]
                    });

                    const $dots = $('.slick-dots');
                    const scrollbarClass = 'slick-scrollbar';
                    const id = 'ssb-' + (Math.random() + 1).toString(36).slice(2);
                    const maxIdx = Math.max(0, $dots.find('li').length - 1);

                    $(`.${scrollbarClass}`).remove();

                    const barHtml = `
      <div class="${scrollbarClass} ${id}">
        <input type="range" min="0" max="${maxIdx}" step="1" value="0" />
      </div>`;
                    $(barHtml).insertAfter($dots);

                    let lastVal = 0;
                    $('body').on('input change', `.${scrollbarClass} input`, function () {
                        const v = Number(this.value) || 0;
                        if (v !== lastVal) {
                            lastVal = v;
                            $slider.slick('slickGoTo', v);
                        }
                    });

                    $slider.on('beforeChange', function (e, slick, curr, next) {
                        const $range = $(`.${scrollbarClass} input`);
                        if (!$range.is(':focus')) {
                            lastVal = next;
                            $range.val(next);
                        }
                    });
                });
            </script>
    </main>
    <footer>
        <div class="footer_top">
            <ul>
                <li>공연관련<img src="image/small_arrow_top.png" alt=""></li>
                <li>전시관련<img src="image/small_arrow_top.png" alt=""></li>
                <li>교육관련<img src="image/small_arrow_top.png" alt=""></li>
                <li>유관기관<img src="image/small_arrow_top.png" alt=""></li>
                <li>협력기관<img src="image/small_arrow_top.png" alt=""></li>
            </ul>
        </div>
        <div class="footer_bottom">
            <img src="image/logo_ft.png" alt="">
            <div>
                <ul class="footer_01">
                    <li>개인정보처리방침</li>
                    <li>행정서비스현장</li>
                    <li>영상정보처리기기 운영</li>
                    <li>이메일집단수집거부</li>
                    <li>찾아오시는길</li>
                </ul>
                <ul class="footer_02">
                    <li>(42672) 대구광역시 달서구 공원순환로 201</li>
                    <li>대표전화 : 053-430-7600</li>
                    <li>팩스 : 053-430-7609</li>
                </ul>
                <p>본 홈페이지에 게시된 전자우편주소는 개인정보보호법 및 정보통신망법에 따라 무단 수집을 거부합니다. Copyright © Daegu Arts Center All Right
                    Reserved</p>
            </div>
        </div>
    </footer>
</body>

</html>